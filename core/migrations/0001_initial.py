# Generated by Django 5.0.2 on 2026-02-11 16:25

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BankAccount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('bank_name', models.CharField(max_length=50, verbose_name='Nombre del Banco')),
                ('account_number', models.CharField(max_length=50, verbose_name='N煤mero de Cuenta')),
                ('currency', models.CharField(default='GTQ', max_length=3, verbose_name='Moneda')),
                ('balance', models.DecimalField(decimal_places=2, default=0.0, max_digits=12, verbose_name='Saldo Actual')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Cuenta Bancaria',
                'verbose_name_plural': 'Cuentas Bancarias',
            },
        ),
        migrations.CreateModel(
            name='CompanyProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='Nombre Empresa')),
                ('nit', models.CharField(blank=True, max_length=20, null=True, verbose_name='NIT')),
                ('logo', models.ImageField(blank=True, null=True, upload_to='company_logos/')),
                ('address', models.CharField(blank=True, max_length=255, null=True)),
                ('phone', models.CharField(blank=True, max_length=50, null=True)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('currency_symbol', models.CharField(default='Q', max_length=5)),
            ],
        ),
        migrations.CreateModel(
            name='Role',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=80, unique=True)),
            ],
        ),
        migrations.CreateModel(
            name='Company',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='Nombre de la Empresa')),
                ('nit', models.CharField(default='CF', max_length=20, verbose_name='NIT')),
                ('tax_id', models.CharField(max_length=20, unique=True, verbose_name='Identificaci贸n Fiscal')),
                ('address', models.TextField(blank=True, null=True, verbose_name='Direcci贸n Legal')),
                ('phone', models.CharField(blank=True, max_length=20, null=True, verbose_name='Tel茅fono')),
                ('email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Correo Electr贸nico')),
                ('logo', models.ImageField(blank=True, null=True, upload_to='logos/')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('active', models.BooleanField(default=True)),
                ('owner', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='owned_companies', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Empresa',
                'verbose_name_plural': 'Empresas',
            },
        ),
        migrations.CreateModel(
            name='BusinessPartner',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='Raz贸n Social / Nombre')),
                ('tax_id', models.CharField(max_length=20, verbose_name='NIT')),
                ('nit', models.CharField(blank=True, max_length=20, null=True, verbose_name='NIT (Opcional)')),
                ('type', models.CharField(choices=[('C', 'Cliente'), ('P', 'Proveedor'), ('A', 'Ambos')], default='CLIENTE', max_length=10, verbose_name='Tipo Texto')),
                ('partner_type', models.CharField(choices=[('C', 'Cliente'), ('P', 'Proveedor'), ('A', 'Ambos')], default='P', max_length=1, verbose_name='Tipo C贸digo')),
                ('bank_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='Banco del Proveedor')),
                ('bank_account', models.CharField(blank=True, max_length=50, null=True, verbose_name='No. Cuenta Proveedor')),
                ('account_type', models.CharField(blank=True, default='Monetaria', max_length=50, null=True, verbose_name='Tipo Cuenta')),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('phone', models.CharField(blank=True, max_length=20, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.company')),
            ],
        ),
        migrations.CreateModel(
            name='Client',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='Raz贸n Social / Nombre')),
                ('nit', models.CharField(max_length=20, unique=True, verbose_name='NIT')),
                ('address', models.CharField(blank=True, max_length=255, verbose_name='Direcci贸n Fiscal')),
                ('phone', models.CharField(blank=True, max_length=20, verbose_name='Tel茅fono')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email Facturaci贸n')),
                ('contact_name', models.CharField(blank=True, max_length=100, verbose_name='Nombre de Contacto')),
                ('credit_days', models.IntegerField(default=0, verbose_name='D铆as de Cr茅dito')),
                ('credit_limit', models.DecimalField(decimal_places=2, default=0.0, max_digits=12, verbose_name='L铆mite de Cr茅dito')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('is_active', models.BooleanField(default=True, verbose_name='Activo')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.companyprofile')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Branch',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='Sucursal')),
                ('code', models.CharField(max_length=20, verbose_name='C贸digo')),
                ('location', models.CharField(blank=True, max_length=255, null=True, verbose_name='Ubicaci贸n/Direcci贸n')),
                ('address', models.CharField(blank=True, max_length=200, null=True, verbose_name='Direcci贸n')),
                ('phone', models.CharField(blank=True, max_length=20, null=True, verbose_name='Tel茅fono')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='branches', to='core.company')),
                ('company_profile', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='branches_profile', to='core.companyprofile')),
            ],
            options={
                'verbose_name': 'Sucursal',
                'verbose_name_plural': 'Sucursales',
            },
        ),
        migrations.CreateModel(
            name='BankTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(verbose_name='Fecha')),
                ('movement_type', models.CharField(choices=[('IN', 'Entrada / Dep贸sito'), ('OUT', 'Salida / Retiro')], default='OUT', max_length=3)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Monto')),
                ('description', models.CharField(max_length=255, verbose_name='Descripci贸n')),
                ('reference', models.CharField(blank=True, max_length=100, null=True, verbose_name='Referencia')),
                ('evidence', models.ImageField(blank=True, null=True, upload_to='bank_evidence/', verbose_name='Comprobante')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.bankaccount')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='BankMovement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(default=django.utils.timezone.now, verbose_name='Fecha')),
                ('movement_type', models.CharField(choices=[('IN', 'Dep贸sito'), ('OUT', 'Retiro/Cheque')], max_length=3)),
                ('category', models.CharField(default='General', max_length=50)),
                ('description', models.CharField(max_length=255, verbose_name='Descripci贸n')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15, verbose_name='Monto')),
                ('reference', models.CharField(blank=True, max_length=100, null=True, verbose_name='Referencia / No. Cheque')),
                ('evidence', models.ImageField(blank=True, null=True, upload_to='bank_movements/', verbose_name='Comprobante')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='movements', to='core.bankaccount')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='bankaccount',
            name='company',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa'),
        ),
        migrations.CreateModel(
            name='Account',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=20, unique=True, verbose_name='C贸digo Cuenta')),
                ('name', models.CharField(max_length=200, verbose_name='Nombre de la Cuenta')),
                ('account_type', models.CharField(choices=[('ACTIVO', 'Activo'), ('PASIVO', 'Pasivo'), ('PATRIMONIO', 'Patrimonio/Capital'), ('INGRESO', 'Ingresos'), ('GASTO', 'Gastos'), ('COSTO', 'Costos de Venta')], max_length=20, verbose_name='Tipo de Cuenta')),
                ('is_group', models.BooleanField(default=False, help_text='Marcar si es t铆tulo de grupo', verbose_name='驴Es Grupo?')),
                ('balance', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='Saldo Actual')),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='core.account', verbose_name='Cuenta Padre')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'verbose_name': 'Cuenta Contable',
                'verbose_name_plural': 'Nomenclatura Contable',
                'ordering': ['code'],
            },
        ),
        migrations.CreateModel(
            name='CreditCard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('bank_name', models.CharField(max_length=100)),
                ('alias', models.CharField(max_length=100)),
                ('last_4_digits', models.CharField(max_length=4)),
                ('credit_limit', models.DecimalField(decimal_places=2, max_digits=12)),
                ('current_balance', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('cutoff_day', models.IntegerField()),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Employee',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('first_name', models.CharField(max_length=100, verbose_name='Nombres')),
                ('last_name', models.CharField(max_length=100, verbose_name='Apellidos')),
                ('dpi', models.CharField(max_length=20, unique=True, verbose_name='DPI')),
                ('nit', models.CharField(blank=True, max_length=20, null=True, verbose_name='NIT')),
                ('address', models.CharField(max_length=200, verbose_name='Direcci贸n')),
                ('phone', models.CharField(max_length=20, verbose_name='Tel茅fono')),
                ('position', models.CharField(max_length=100, verbose_name='Puesto')),
                ('department', models.CharField(max_length=100, verbose_name='Departamento')),
                ('date_hired', models.DateField(verbose_name='Fecha Contrataci贸n')),
                ('base_salary', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Salario Base')),
                ('bonus', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='Bonificaci贸n')),
                ('igss_number', models.CharField(blank=True, max_length=20, null=True, verbose_name='No. IGSS')),
                ('branch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.branch', verbose_name='Sucursal Asignada')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile')),
                ('user', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Usuario de Sistema')),
            ],
            options={
                'verbose_name': 'Empleado',
                'verbose_name_plural': 'Empleados',
            },
        ),
        migrations.CreateModel(
            name='Expense',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(verbose_name='Fecha')),
                ('provider', models.CharField(max_length=200, verbose_name='Proveedor')),
                ('description', models.CharField(max_length=255, verbose_name='Concepto')),
                ('invoice_file', models.FileField(blank=True, null=True, upload_to='gastos/', verbose_name='Factura')),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Total Factura')),
                ('idp_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='IDP')),
                ('vat_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='IVA Cr茅dito')),
                ('base_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='Costo/Gasto')),
                ('is_fuel', models.BooleanField(default=False, verbose_name='Es Combustible')),
                ('payment_method', models.CharField(choices=[('CASH', 'Efectivo / Caja Chica'), ('CARD', 'Tarjeta de Cr茅dito / D茅bito'), ('TRANSFER', 'Transferencia Bancaria'), ('CHECK', 'Cheque'), ('CREDIT', 'Cr茅dito (Cuenta por Pagar)')], default='CASH', max_length=20, verbose_name='M茅todo de Pago')),
                ('status', models.CharField(choices=[('PENDING', ' Pendiente (Solo Foto)'), ('APPROVED', ' Aprobado y Contabilizado'), ('REJECTED', ' Rechazado')], default='APPROVED', max_length=10)),
                ('accounting_entry_id', models.IntegerField(blank=True, null=True, verbose_name='ID Partida (Legacy)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('credit_card', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.creditcard', verbose_name='Tarjeta Usada')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Income',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(default=django.utils.timezone.now, verbose_name='Fecha')),
                ('description', models.CharField(max_length=200, verbose_name='Descripci贸n / Cliente')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Monto Total')),
                ('reference_doc', models.CharField(blank=True, max_length=50, verbose_name='No. Factura/Recibo')),
                ('evidence', models.ImageField(blank=True, null=True, upload_to='incomes/', verbose_name='Comprobante')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('bank_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.bankaccount', verbose_name='Cuenta Destino')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.company')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Invoice',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(auto_now_add=True)),
                ('due_date', models.DateField()),
                ('payment_method', models.CharField(choices=[('CONTADO', 'Contado'), ('CREDITO', 'Cr茅dito')], max_length=50)),
                ('fel_uuid', models.CharField(blank=True, max_length=100, null=True, verbose_name='UUID Fiscal')),
                ('fel_series', models.CharField(blank=True, max_length=50, null=True)),
                ('fel_number', models.CharField(blank=True, max_length=50, null=True)),
                ('total', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.client')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='JournalEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(verbose_name='Fecha Contable')),
                ('description', models.CharField(max_length=255, verbose_name='Descripci贸n / Glosa')),
                ('reference', models.CharField(blank=True, max_length=100, verbose_name='Referencia (Doc/Fac)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('is_posted', models.BooleanField(default=False, verbose_name='Asentada (Definitiva)')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('expense', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='journal_entry', to='core.expense', verbose_name='Origen Gasto')),
            ],
            options={
                'verbose_name': 'Partida Diario',
                'verbose_name_plural': 'Libro Diario',
                'ordering': ['-date', '-id'],
            },
        ),
        migrations.CreateModel(
            name='JournalItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('description', models.CharField(blank=True, max_length=255, verbose_name='Concepto de L铆nea')),
                ('debit', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='Debe')),
                ('credit', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='Haber')),
                ('account', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.account', verbose_name='Cuenta')),
                ('entry', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='core.journalentry')),
            ],
        ),
        migrations.CreateModel(
            name='Loan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Monto Pr茅stamo')),
                ('monthly_fee', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Cuota Mensual')),
                ('balance', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Saldo Pendiente')),
                ('reason', models.CharField(max_length=200, verbose_name='Motivo')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('is_active', models.BooleanField(default=True)),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.employee', verbose_name='Empleado')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Payroll',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('month', models.IntegerField(verbose_name='Mes')),
                ('year', models.IntegerField(verbose_name='A帽o')),
                ('date_generated', models.DateField(auto_now_add=True)),
                ('total_amount', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('is_closed', models.BooleanField(default=False, verbose_name='Cerrada')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='core_payrolls', to='core.company')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='PayrollDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('base_salary', models.DecimalField(decimal_places=2, max_digits=10)),
                ('bonus', models.DecimalField(decimal_places=2, max_digits=10)),
                ('igss_deduction', models.DecimalField(decimal_places=2, max_digits=10)),
                ('loan_deduction', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('isr_deduction', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('other_deductions', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('total_income', models.DecimalField(decimal_places=2, max_digits=10)),
                ('total_deductions', models.DecimalField(decimal_places=2, max_digits=10)),
                ('net_salary', models.DecimalField(decimal_places=2, max_digits=10)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.employee')),
                ('payroll', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.payroll')),
            ],
        ),
        migrations.CreateModel(
            name='Product',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='Nombre Producto')),
                ('code', models.CharField(blank=True, max_length=50, null=True, verbose_name='C贸digo/SKU')),
                ('description', models.TextField(blank=True, null=True)),
                ('price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Precio Venta')),
                ('cost', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='Costo')),
                ('image', models.ImageField(blank=True, null=True, upload_to='products/')),
                ('stock', models.IntegerField(default=0, verbose_name='Stock F铆sico')),
                ('stock_reserved', models.IntegerField(default=0, verbose_name='Apartado en Cotizaciones')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='InvoiceDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.IntegerField()),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=10)),
                ('invoice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='core.invoice')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.product')),
            ],
        ),
        migrations.CreateModel(
            name='InventoryMovement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.IntegerField()),
                ('type', models.CharField(choices=[('IN', 'Entrada'), ('OUT', 'Salida')], max_length=3)),
                ('date', models.DateTimeField(default=django.utils.timezone.now)),
                ('reference', models.CharField(max_length=200)),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='inventory_history_legacy', to=settings.AUTH_USER_MODEL)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.product')),
            ],
        ),
        migrations.CreateModel(
            name='Provider',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Raz贸n Social / Nombre')),
                ('nit', models.CharField(blank=True, max_length=20, verbose_name='NIT')),
                ('contact_name', models.CharField(blank=True, max_length=100, verbose_name='Contacto')),
                ('phone', models.CharField(blank=True, max_length=20, verbose_name='Tel茅fono')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'verbose_name': 'Proveedor (Simple)',
                'verbose_name_plural': 'Proveedores (Simple)',
            },
        ),
        migrations.CreateModel(
            name='Purchase',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(default=django.utils.timezone.now, verbose_name='Fecha de Compra')),
                ('document_reference', models.CharField(blank=True, max_length=50, null=True, verbose_name='No. Factura Proveedor')),
                ('payment_method', models.CharField(choices=[('CASH', 'Efectivo'), ('TRANSFER', 'Transferencia Bancaria'), ('CARD', 'Tarjeta de Cr茅dito/D茅bito'), ('CHECK', 'Cheque'), ('CREDIT', 'Cr茅dito (Por Pagar)')], default='CASH', max_length=20, verbose_name='M茅todo de Pago')),
                ('payment_reference', models.CharField(blank=True, max_length=100, null=True, verbose_name='Cuenta / Referencia / Tarjeta')),
                ('total', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('status', models.CharField(choices=[('DRAFT', 'Borrador'), ('RECEIVED', 'Recibido / Inventario Cargado'), ('CANCELLED', 'Cancelada')], default='RECEIVED', max_length=20, verbose_name='Estado')),
                ('description', models.TextField(blank=True, null=True, verbose_name='Observaciones')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Comprador')),
            ],
            options={
                'verbose_name': 'Compra',
                'verbose_name_plural': 'Compras',
            },
        ),
        migrations.CreateModel(
            name='PurchaseDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.PositiveIntegerField(verbose_name='Cantidad')),
                ('unit_cost', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Costo Unitario')),
                ('subtotal', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.product', verbose_name='Producto')),
                ('purchase', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='core.purchase')),
            ],
        ),
        migrations.CreateModel(
            name='Quotation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(default=django.utils.timezone.now)),
                ('valid_until', models.DateField(blank=True, null=True)),
                ('total', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('observation', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('DRAFT', 'Borrador (Aparta Stock)'), ('BILLED', 'Facturada (Rebaja Stock)'), ('CANCELED', 'Cancelada (Libera Stock)')], default='DRAFT', max_length=10)),
                ('payment_method', models.CharField(choices=[('EFECTIVO', 'Efectivo'), ('TRANSFERENCIA', 'Transferencia'), ('CHEQUE', 'Cheque'), ('CREDITO', 'Cr茅dito / Por Cobrar')], default='EFECTIVO', max_length=50, verbose_name='M茅todo de Pago')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.client')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='invoice',
            name='origin_quotation',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.quotation'),
        ),
        migrations.CreateModel(
            name='QuotationDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.IntegerField()),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=10)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.product')),
                ('quotation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='core.quotation')),
            ],
        ),
        migrations.CreateModel(
            name='Sale',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Venta')),
                ('payment_method', models.CharField(choices=[('EFECTIVO', 'Efectivo'), ('TRANSFERENCIA', 'Transferencia'), ('CHEQUE', 'Cheque'), ('CREDITO', 'Cr茅dito / Por Cobrar')], default='EFECTIVO', max_length=50, verbose_name='M茅todo de Pago')),
                ('total', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('invoice_number', models.CharField(blank=True, max_length=50, verbose_name='No. Factura/Recibo')),
                ('branch', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.branch', verbose_name='Sucursal de Facturaci贸n')),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.client', verbose_name='Cliente')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('quotation_origin', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.quotation', verbose_name='Cotizaci贸n Origen')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Vendedor')),
            ],
            options={
                'verbose_name': 'Venta',
                'verbose_name_plural': 'Ventas',
            },
        ),
        migrations.CreateModel(
            name='SaleDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.PositiveIntegerField(verbose_name='Cantidad')),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Precio Unitario')),
                ('subtotal', models.DecimalField(decimal_places=2, editable=False, max_digits=10)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.product')),
                ('sale', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='core.sale')),
            ],
        ),
        migrations.CreateModel(
            name='Supplier',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='Raz贸n Social / Nombre')),
                ('nit', models.CharField(blank=True, max_length=20, null=True, verbose_name='NIT / RUT')),
                ('phone', models.CharField(blank=True, max_length=20, null=True, verbose_name='Tel茅fono')),
                ('email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Correo Electr贸nico')),
                ('address', models.TextField(blank=True, null=True, verbose_name='Direcci贸n')),
                ('contact_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='Nombre de Contacto')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'verbose_name': 'Proveedor',
                'verbose_name_plural': 'Proveedores',
            },
        ),
        migrations.AddField(
            model_name='purchase',
            name='supplier',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.supplier', verbose_name='Proveedor'),
        ),
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('active_company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='active_users', to='core.company')),
                ('allowed_companies', models.ManyToManyField(to='core.company', verbose_name='Empresas Permitidas')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='profile', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='UserRoleCompany',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.company')),
                ('role', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.role')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'unique_together': {('user', 'role', 'company')},
            },
        ),
        migrations.AddField(
            model_name='company',
            name='users',
            field=models.ManyToManyField(related_name='companies_assigned', through='core.UserRoleCompany', to=settings.AUTH_USER_MODEL),
        ),
        migrations.CreateModel(
            name='Vehicle',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('brand', models.CharField(max_length=50)),
                ('model', models.CharField(max_length=50)),
                ('plate', models.CharField(max_length=20, unique=True)),
                ('year', models.IntegerField()),
                ('color', models.CharField(blank=True, max_length=30, null=True)),
                ('assigned_driver', models.CharField(blank=True, max_length=100, null=True)),
                ('status', models.CharField(choices=[('ACTIVO', 'Activo'), ('TALLER', 'Taller')], default='ACTIVO', max_length=20)),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='expense',
            name='vehicle',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.vehicle', verbose_name='Veh铆culo'),
        ),
        migrations.CreateModel(
            name='Warehouse',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nombre Bodega')),
                ('is_main', models.BooleanField(default=False, verbose_name='驴Principal?')),
                ('active', models.BooleanField(default=True, verbose_name='Activa')),
                ('branch', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='warehouses', to='core.branch', verbose_name='Sucursal')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='sub_warehouses', to='core.warehouse', verbose_name='Bodega Padre')),
            ],
            options={
                'verbose_name': 'Bodega',
                'verbose_name_plural': 'Bodegas',
            },
        ),
        migrations.CreateModel(
            name='StockMovement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.IntegerField(verbose_name='Cantidad')),
                ('movement_type', models.CharField(choices=[('IN_PURCHASE', 'Entrada por Compra'), ('OUT_SALE', 'Salida por Venta'), ('TRANSFER_OUT', 'Salida por Traslado'), ('TRANSFER_IN', 'Entrada por Traslado'), ('ADJUST_ADD', 'Ajuste (Entrada)'), ('ADJUST_SUB', 'Ajuste (Salida)')], max_length=20, verbose_name='Tipo de Movimiento')),
                ('related_transfer_id', models.IntegerField(blank=True, help_text='ID del grupo de traslado', null=True)),
                ('date', models.DateTimeField(auto_now_add=True, verbose_name='Fecha y Hora')),
                ('comments', models.CharField(blank=True, max_length=200, null=True, verbose_name='Comentario/Raz贸n')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.product', verbose_name='Producto')),
                ('related_purchase', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.purchase', verbose_name='Ref. Compra')),
                ('related_sale', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.sale', verbose_name='Ref. Venta')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('warehouse', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.warehouse', verbose_name='Bodega Afectada')),
            ],
            options={
                'verbose_name': 'Movimiento de Kardex',
                'verbose_name_plural': 'Kardex (Historial)',
                'ordering': ['-date'],
            },
        ),
        migrations.AddField(
            model_name='sale',
            name='warehouse',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.warehouse', verbose_name='Bodega de Despacho'),
        ),
        migrations.AddField(
            model_name='purchase',
            name='warehouse',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.warehouse', verbose_name='Bodega de Entrada'),
        ),
        migrations.CreateModel(
            name='Inventory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.IntegerField(default=0, verbose_name='Existencia Actual')),
                ('min_stock', models.IntegerField(default=5, verbose_name='Stock M铆nimo en esta Bodega')),
                ('location', models.CharField(blank=True, max_length=50, null=True, verbose_name='Ubicaci贸n/Estante')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.companyprofile', verbose_name='Empresa')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.product', verbose_name='Producto')),
                ('warehouse', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.warehouse', verbose_name='Bodega')),
            ],
            options={
                'verbose_name': 'Inventario por Bodega',
                'verbose_name_plural': 'Inventarios por Bodega',
                'unique_together': {('warehouse', 'product')},
            },
        ),
    ]
